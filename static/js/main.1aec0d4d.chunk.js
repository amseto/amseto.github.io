(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{33:function(e,n,o){e.exports={grid:"Grid_grid__9Fsru"}},34:function(e,n,o){e.exports={block:"Block_block__1kjjl",None:"Block_None__ltR1S",I:"Block_I__1Pnys",T:"Block_T__WdEBm",L:"Block_L__1zsbc",J:"Block_J__2iV29",Z:"Block_Z__28EjD",S:"Block_S__MKS_j",O:"Block_O__3X5pc",Ighost:"Block_Ighost__1pBKL",Tghost:"Block_Tghost__2h680",Lghost:"Block_Lghost__3KiXo",Jghost:"Block_Jghost__9BTwX",Zghost:"Block_Zghost__3ytmC",Sghost:"Block_Sghost__1z9Pj",Oghost:"Block_Oghost__34NVA"}},35:function(e,n,o){e.exports={pieceQueue:"PieceQueue_pieceQueue__N5gJS"}},36:function(e,n,o){e.exports={heldBlock:"HeldBlock_heldBlock__2nV0f"}},38:function(e,n,o){e.exports={backdrop:"WaitingMessage_backdrop__1TWDa",modal:"WaitingMessage_modal__2ko18"}},44:function(e,n,o){e.exports={howToPlay:"HowToPlay_howToPlay__2-hPX"}},45:function(e,n,o){e.exports={"nav-bar":"NavigationBar_nav-bar__2WU1z"}},58:function(e,n,o){},60:function(e,n,o){"use strict";o.r(n);var t=o(40),r=o.n(t),c=o(11),N=(o(58),o(13)),a=o(22),s=o(12),i=o(7),u=o.n(i),l=o(0),j=o(2),d=o(43),b=(Object(d.a)({apiKey:"AIzaSyA9ipNK6_boqbwThQlJgolni-O5iIgIl40",authDomain:"ditris-2244c.firebaseapp.com",databaseURL:"https://ditris-2244c-default-rtdb.firebaseio.com",projectId:"ditris-2244c",storageBucket:"ditris-2244c.appspot.com",messagingSenderId:"743373731037",appId:"1:743373731037:web:9552a80db8b0df8d875734"}),Object(a.a)()),f=Object(s.c)(),h=Object(s.j)(f),O=Object(s.a)(h,"users"),p=Object(s.a)(h,"rooms"),g=function(){var e=Object(j.a)(Object(l.a)().mark((function e(n){var o;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.b)(Object(s.a)(O,n)).then((function(e){o=e.val().username}));case 2:return e.abrupt("return",o);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),y=o(15),m=o(10),x=o(25),v={I:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],T:[[[0,1,0],[1,1,1]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],L:[[[0,0,1],[1,1,1]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],Z:[[[1,1,0],[0,1,1]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],S:[[[0,1,1],[1,1,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],O:[[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]]]},P=o(4),w=o(5),S=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],k=function(){0===S.length&&(S=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"]);var e=Math.floor(S.length*Math.random());return S.splice(e,1)},_=null,I=function(e,n,o,t){return v[e][n].map((function(e,n){return e.map((function(e,r){return e?{x:o+r,y:t+n}:null}))}))},L=function(e,n){var o,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],c=Object(m.a)(n);try{for(c.s();!(o=c.n()).done;){var N,a=o.value,s=Object(m.a)(a);try{for(s.s();!(N=s.n()).done;){var i=N.value;i&&A(e,i,t)&&r.push(i)}}catch(u){s.e(u)}finally{s.f()}}}catch(u){c.e(u)}finally{c.f()}return r},C=function(e){var n,o=Object(m.a)(e.currentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(r){o.e(r)}finally{o.f()}},R=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n){var o,t=e.currentShape+"ghost",r=Object(m.a)(e.ghostCoords);try{for(r.s();!(o=r.n()).done;){var c=o.value;e.grid[c.y][c.x]=t;var N,a=Object(m.a)(e.currentCoords);try{for(a.s();!(N=a.n()).done;){var i=N.value;i.y===c.y&&i.x===c.x&&(e.grid[c.y][c.x]=e.currentShape)}}catch(d){a.e(d)}finally{a.f()}}}catch(d){r.e(d)}finally{r.f()}}else{var u,l=Object(m.a)(e.currentCoords);try{for(l.s();!(u=l.n()).done;){var j=u.value;e.grid[j.y][j.x]=e.currentShape}}catch(d){l.e(d)}finally{l.f()}e.multiplayer&&1===e.playerNumber&&Object(s.l)(Object(s.a)(_,"grid"),e.grid)}},A=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n&&n.y<=20&&n.x>=0&&n.x<=9){var t,r=Object(m.a)(e.currentCoords);try{for(r.s();!(t=r.n()).done;){var c=t.value;if(o&&c.y===n.y&&c.x===n.x)return!0}}catch(N){r.e(N)}finally{r.f()}if(e.grid[n.y][n.x].length>1)return!0}return!1},G=new(function(){function e(){Object(P.a)(this,e),this.elements={},this.head=0,this.tail=0}return Object(w.a)(e,[{key:"enqueue",value:function(e){this.elements[this.tail]=e,this.tail++}},{key:"dequeue",value:function(){var e=this.elements[this.head];return delete this.elements[this.head],this.head++,e}},{key:"peek",value:function(){return this.elements[this.head]}},{key:"empty",value:function(){for(;!this.isEmpty;)this.dequeue()}},{key:"length",get:function(){return this.tail-this.head}},{key:"isEmpty",get:function(){return 0===this.length}}]),e}()),T=Object(x.b)({name:"gameState",initialState:{gameRunning:!1,currentShape:null,currentCoords:[],ghostCoords:[],currentPieceState:"NONE",rotatePos:0,xPos:3,yPos:0,totalLinesCleared:0,grid:[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],pieceQueue:null,isGameWon:!1,heldPiece:null,rotated:!1,displayMessage:null,multiplayer:null,playerNumber:null},reducers:{reset:function(e){S=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.totalLinesCleared=0,e.displayMessage=null,e.currentPieceState="GETTING READY",G.empty(),e.gameRunning=!1},newGame:function(e){S=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.totalLinesCleared=0,e.displayMessage="READY",e.currentPieceState="GETTING READY",G.empty(),e.gameRunning=!1},gettingReady:function(e){if("GETTING READY"===e.currentPieceState)e.currentPieceState="BEFORE START",e.displayMessage="GO!";else if("BEFORE START"===e.currentPieceState){e.displayMessage=null,e.gameRunning=!0,e.currentShape=k()[0];for(var n=0;n<5;n++)G.enqueue.apply(G,Object(y.a)(k()))}},clearLines:function(e){var n,o=[],t=0,r=Object(m.a)(e.grid);try{for(r.s();!(n=r.n()).done;){var c=n.value;c.every((function(e){return"None"!==e}))?(e.totalLinesCleared+=1,t+=1):o.push(c)}}catch(a){r.e(a)}finally{r.f()}for(var N=0;N<t;N++)o.unshift(["None","None","None","None","None","None","None","None","None","None"]);e.grid=o},getNewPiece:function(e){if(e.gameRunning){if(e.ghostCoords=[],e.rotated=!1,e.currentShape=G.dequeue(),G.enqueue.apply(G,Object(y.a)(k())),e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4)return e.gameRunning=!1,e.displayMessage="YOU LOST",void console.log("lost");R(e),e.currentPieceState="FALLING"}},rotatePiece:function(e,n){var o=e.rotatePos;e.rotatePos=function(e,n){var o=n.rotatePos;return e?0===o?3:o-1:3===o?0:o+1}(n.payload,{rotatePos:e.rotatePos}),C(e),e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.rotatePos=o,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",R(e)},dropPiece:function(e){if(e.gameRunning){if("LANDING"===e.currentPieceState)return void(e.currentPieceState="FROZEN");C(e),e.yPos+=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.yPos-=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentPieceState="LANDING"):e.currentPieceState="FALLING",R(e)}},getGhostCoords:function(e){if(e.gameRunning){!function(e){var n,o=Object(m.a)(e.ghostCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.grid[t.y][t.x]="None"}}catch(r){o.e(r)}finally{o.f()}}(e),e.ghostCoords=[];var n,o=Object(m.a)(e.currentCoords);try{for(o.s();!(n=o.n()).done;){var t=n.value;e.ghostCoords.push({x:t.x,y:t.y})}}catch(c){o.e(c)}finally{o.f()}for(var r=e.yPos;4===e.ghostCoords.length;)r+=1,e.ghostCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,r),!0);r-=1,e.ghostCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,r),!0)}},hardDrop:function(e){C(e),e.currentCoords=e.ghostCoords,R(e),e.currentPieceState="FROZEN"},showGhostPiece:function(e){e.gameRunning&&R(e,!0)},shiftLeft:function(e){C(e),e.xPos-=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos+=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",R(e)},shiftRight:function(e){C(e),e.xPos+=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos-=1,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",R(e)},checkIfGameWon:function(e){e.totalLinesCleared>=4&&(console.log("won"),e.isGameWon=!0,e.gameRunning=!1,e.displayMessage="YOU WON")},holdPiece:function(e){if(!0!==e.rotated){if(e.rotated=!0,C(e),null===e.heldPiece)e.heldPiece=e.currentShape,e.currentShape=G.dequeue(),G.enqueue.apply(G,Object(y.a)(k()));else{var n=e.currentShape;e.currentShape=e.heldPiece,e.heldPiece=n}e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=L(e,I(e.currentShape,e.rotatePos,e.xPos,e.yPos)),R(e),e.currentPieceState="FALLING"}},setMultiplayer:function(e,n){e.multiplayer=!0,e.playerNumber=n.payload.playerNumber,_=n.payload.roomRef}}}),D=T.actions,B=T.reducer,E=o(33),K=o.n(E),U=o(34),F=o.n(U),J=o(6),M=function(e){var n=e.color;return Object(J.jsx)("td",{className:"".concat(F.a.block,"  ").concat(F.a[n])})},Z=function(){var e=Object(c.c)((function(e){return e.gameState}));return Object(J.jsx)("div",{style:{position:"absolute",color:"yellow",marginLeft:90,marginTop:240,fontSize:"300%",width:"100%"},children:e.displayMessage})},q=function(){var e=Object(c.c)((function(e){return e.gameState})),n=Object(c.c)((function(e){return e.userInfo.grid}));if(console.log(n),0!==n.length){var o=n.payload.slice(1).map((function(e,n){return Object(J.jsx)("tr",{children:e.map((function(e,n){return Object(J.jsx)(M,{color:e},n)}))},n)}));return Object(J.jsx)("table",{className:K.a.grid,children:Object(J.jsx)("tbody",{children:o})})}var t=e.grid.slice(1).map((function(e,n){return Object(J.jsx)("tr",{children:e.map((function(e,n){return Object(J.jsx)(M,{color:e},n)}))},n)}));return Object(J.jsxs)("table",{className:K.a.grid,children:[Object(J.jsx)("tbody",{children:t}),Object(J.jsx)(Z,{})]})},W=function(e){var n=v[e.color][0].map((function(n,o){return Object(J.jsx)("tr",{children:n.map((function(n,o){return 0===n?Object(J.jsx)(M,{color:null},o):Object(J.jsx)(M,{color:e.color},o)}))},o)}));return Object(J.jsx)("li",{children:Object(J.jsx)("table",{children:Object(J.jsx)("tbody",{children:n})})})},Q=o(35),Y=o.n(Q),z=function(e){var n=0,o=[];if(G.isEmpty)return Object(J.jsx)("ul",{className:Y.a.pieceQueue});for(var t in G.elements)o.push(Object(J.jsx)(W,{color:G.elements[t]},n++));return Object(J.jsx)("ul",{className:Y.a.pieceQueue,children:o})},X=o(36),V=o.n(X),H=function(){var e=Object(c.c)((function(e){return e.gameState}));if(!e.heldPiece)return Object(J.jsx)("div",{className:V.a.heldBlock,children:Object(J.jsx)("table",{children:Object(J.jsxs)("tbody",{children:[Object(J.jsxs)("tr",{children:[Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{})]}),Object(J.jsxs)("tr",{children:[Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{})]}),Object(J.jsxs)("tr",{children:[Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{}),Object(J.jsx)(M,{})]})]})})});var n=v[e.heldPiece][0].map((function(n,o){return Object(J.jsx)("tr",{children:n.map((function(n,o){return 0===n?Object(J.jsx)(M,{color:null},o):Object(J.jsx)(M,{color:e.heldPiece},o)}))},o)}));return Object(J.jsx)("div",{className:V.a.heldBlock,children:Object(J.jsx)("table",{children:Object(J.jsx)("tbody",{children:n})})})},$={},ee={},ne={},oe=function(){window.addEventListener("keydown",(function(e){$[e.key]=!0,"Tab"===e.key&&(e.preventDefault(),e.stopPropagation())," "===e.key&&(e.preventDefault(),e.stopPropagation()),"ArrowDown"===e.key&&(e.preventDefault(),e.stopPropagation()),"ArrowUp"===e.key&&(e.preventDefault(),e.stopPropagation())})),window.addEventListener("keyup",(function(e){ne[e.key]=0,$[e.key]=!1,ee[e.key]=!1}))},te=o(44),re=o.n(te),ce=function(){return Object(J.jsx)("div",{className:re.a.howToPlay,children:Object(J.jsxs)("ul",{children:[Object(J.jsx)("li",{children:"esc = start game"}),Object(J.jsx)("li",{children:"q = rotate counter clockwise"}),Object(J.jsx)("li",{children:"w = rotate clockwise"}),Object(J.jsx)("li",{children:"tab = hold"}),Object(J.jsx)("li",{children:"spacebar = hard drop"}),Object(J.jsx)("li",{children:"use arrows to move"})]})})},Ne=!1,ae=function(){var e=Object(c.b)(),n=Object(c.c)((function(e){return e.gameState.gameRunning})),o=Object(c.c)((function(e){return e.gameState.currentPieceState})),t=Object(c.c)((function(e){return e.gameState.displayMessage})),r=Object(i.useState)(!1),a=Object(N.a)(r,2),s=a[0],u=a[1];Object(i.useEffect)((function(){var t=window.setInterval((function(){n&&("FROZEN"===o?(e(D.clearLines()),e(D.checkIfGameWon()),e(D.getNewPiece()),e(D.getGhostCoords()),e(D.showGhostPiece())):(e(D.dropPiece()),e(D.getGhostCoords()),e(D.showGhostPiece())))}),300),r=window.setInterval((function(){j()}),1),c=window.setInterval((function(){l()}),1);return function(){window.clearInterval(t),window.clearInterval(r),window.clearInterval(c)}})),Object(i.useEffect)((function(){if(s){var n=window.setInterval((function(){e(D.gettingReady())}),500);return function(){window.clearInterval(n)}}}),[t,e,s]);var l=function(){if(n&&!Ne){for(var o in ne)ne[o]&&(ne[o]+=1);$.ArrowDown&&ee.ArrowDown&&ne.ArrowDown>40&&(e(D.dropPiece()),ee.ArrowDown=!0,ne.ArrowDown=30),$.ArrowRight&&ee.ArrowRight&&ne.ArrowRight>40&&(e(D.shiftRight()),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.ArrowRight=!0,ne.ArrowRight=20),$.ArrowLeft&&ee.ArrowLeft&&ne.ArrowLeft>40&&(e(D.shiftLeft()),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.ArrowLeft=!0,ne.ArrowLeft=20)}},j=function(){n&&!Ne&&($.q&&!ee.q&&(e(D.rotatePiece(!0)),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.q=!0),$.w&&!ee.w&&(e(D.rotatePiece(!1)),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.w=!0),$[" "]&&!ee[" "]&&(Ne=!0,e(D.hardDrop()),ee[" "]=!0,setTimeout((function(){Ne=!1}),400)),$.Tab&&!ee.Tab&&(e(D.holdPiece()),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.Tab=!0),$.ArrowDown&&!ee.ArrowDown&&(ne.ArrowDown=1,e(D.dropPiece()),ee.ArrowDown=!0),$.ArrowRight&&!ee.ArrowRight&&(ne.ArrowRight=1,e(D.shiftRight()),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.ArrowRight=!0),$.ArrowLeft&&!ee.ArrowLeft&&(ne.ArrowLeft=1,e(D.shiftLeft()),e(D.getGhostCoords()),e(D.showGhostPiece()),ee.ArrowLeft=!0))};return document.onkeydown=function(n){"Escape"===n.key&&(u(!0),e(D.newGame()),e(D.getNewPiece()),e(D.getGhostCoords()),e(D.showGhostPiece()))},Object(J.jsxs)(i.Fragment,{children:[Object(J.jsx)(oe,{}),Object(J.jsxs)("div",{style:{display:"flex"},children:[Object(J.jsx)(H,{}),Object(J.jsx)(q,{}),Object(J.jsx)(z,{})]}),Object(J.jsx)(ce,{})]})},se=function(){return Object(J.jsxs)(i.Fragment,{children:[Object(J.jsx)("h1",{children:"Ditris"}),Object(J.jsx)(ae,{})]})},ie=o(37),ue=o(20),le=function(){var e=Object(c.c)((function(e){return e.userInfo.isLoggedIn})),n=Object(i.useState)(""),o=Object(N.a)(n,2),t=o[0],r=o[1],a=function(){var e=Object(j.a)(Object(l.a)().mark((function e(n){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,Object(ie.a)(b);case 3:Object(ue.e)(Object(ue.a)(O,b.currentUser.uid),{username:t,inRoom:!1}),r("");case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),s=function(){var e=Object(j.a)(Object(l.a)().mark((function e(){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(ue.d)(Object(ue.a)(O,b.currentUser.uid)),Object(ie.b)(b);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return e?Object(J.jsx)("button",{onClick:s,children:"Logout"}):Object(J.jsxs)("form",{onSubmit:a,children:[Object(J.jsx)("label",{id:"name",children:"Username: "}),Object(J.jsx)("input",{id:"name",value:t,onChange:function(e){r(e.target.value)}}),Object(J.jsx)("button",{children:"Login"})]})},je=Object(i.memo)(le),de=Object(x.b)({name:"UserInfo",initialState:{isLoggedIn:!1,roomStatus:null,otherUsers:[],roomKey:null,opponentName:"",oppoenentID:null,invitationKeys:[],grid:[]},reducers:{login:function(e){e.isLoggedIn=!0},logout:function(e){e.isLoggedIn=!1},setOtherUsers:function(e,n){e.otherUsers=n},setRoomKey:function(e,n){e.roomKey=n},setRoomStatus:function(e,n){e.roomStatus=n},setOpponentName:function(e,n){e.opponentName=n},setOpponentid:function(e,n){e.opponentID=n},setInvitiationKeys:function(e,n){e.invitationKeys=n},setGrid:function(e,n){console.log(n),e.grid=n}}}),be=de.actions,fe=de.reducer,he=function(e){var n=e.username,o=e.uid,t=Object(c.b)(),r=Object(ue.c)(p),N=function(){var e=Object(j.a)(Object(l.a)().mark((function e(){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(ue.b)(p),e.next=3,Object(ue.e)(r,{player1:b.currentUser.uid,player2:o,accepted:!1});case 3:t(be.setRoomStatus("waiting")),t(be.setRoomKey(r.key)),t(be.setOpponentName(n)),t(be.setOpponentid(o));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(J.jsx)("li",{children:Object(J.jsx)("button",{onClick:N,children:n})})},Oe=function(){var e=Object(c.c)((function(e){return e.userInfo.otherUsers.payload})),n=e?e.map((function(e,n){return Object(J.jsx)(he,{username:e[1].username,uid:e[0]},n)})):null;if(n)return Object(J.jsx)("ul",{children:n})},pe=Object(i.memo)(Oe),ge=o(21),ye=o(38),me=o.n(ye),xe=function(){return Object(J.jsx)("div",{className:me.a.backdrop})},ve=function(e){var n=e.children;return Object(J.jsx)("div",{className:me.a.modal,children:n})},Pe=document.getElementById("overlays"),we=function(){var e=Object(c.b)(),n=Object(c.c)((function(e){return e.userInfo.opponentName.payload})),o=Object(c.c)((function(e){return e.userInfo.opponentID.payload})),t=Object(c.c)((function(e){return e.userInfo.roomKey.payload})),r=function(){var n=Object(j.a)(Object(l.a)().mark((function n(){return Object(l.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(s.k)(Object(s.a)(p,t));case 2:e(be.setRoomKey(null)),e(be.setOpponentName(""));case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(s.g)(Object(s.a)(p,t)).remove(),Object(s.h)(Object(s.a)(O,o),(function(e){e.exists()&&!e.val().inRoom||(r(),console.log("error"))})),Object(J.jsxs)(i.Fragment,{children:[Object(ge.createPortal)(Object(J.jsx)(xe,{}),Pe),Object(ge.createPortal)(Object(J.jsxs)(ve,{children:["Waiting for ",n," to join",Object(J.jsx)("button",{onClick:r,children:"Cancel"})]}),Pe)]})},Se=Object(i.memo)(we),ke=function(e){var n=e.roomKey,o=e.opponentuid,t=Object(c.b)(),r=Object(i.useState)(null),a=Object(N.a)(r,2),u=a[0],d=a[1],b=function(){var e=Object(j.a)(Object(l.a)().mark((function e(){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.next=3,g(o);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return b(),Object(J.jsx)("button",{onClick:function(){Object(s.l)(Object(s.a)(p,n+"/accepted"),!0),t(D.setMultiplayer({playerNumber:2,roomRef:Object(s.a)(p,n)})),t(be.setRoomStatus("done waiting"))},children:u})},_e=function(){var e=Object(c.c)((function(e){return e.userInfo.invitationKeys}));return 0!==e.length&&(e=e.payload.map((function(e,n){var o=e.roomKey,t=e.opponentuid;return Object(J.jsx)(ke,{roomKey:o,opponentuid:t},n)}))),Object(J.jsx)("div",{children:e})},Ie=Object(i.memo)(_e),Le=function(){var e=Object(c.b)(),n=Object(s.a)(_,"grid");return Object(s.h)(n,(function(n){console.log("here"),n.exists()&&e(be.setGrid(n.val()))})),Object(J.jsx)(q,{})},Ce=function(){var e=Object(c.c)((function(e){return e.userInfo.roomStatus.payload})),n=Object(c.c)((function(e){return e.gameState.playerNumber}));return Object(J.jsxs)(i.Fragment,{children:[Object(J.jsx)("h1",{children:"Ditris Two-Player"}),"looking for room"===e&&Object(J.jsx)(Ie,{}),"looking for room"===e&&Object(J.jsx)(pe,{}),"waiting"===e&&Object(J.jsx)(Se,{}),Object(J.jsx)(je,{}),"done waiting"===e&&1===n&&Object(J.jsx)(ae,{}),"done waiting"===e&&2===n&&Object(J.jsx)(Le,{})]})},Re=o(45),Ae=o.n(Re),Ge=function(e){var n=e.setPage;return Object(J.jsxs)("ul",{className:Ae.a["nav-bar"],children:[Object(J.jsx)("li",{onClick:function(){n("singleplayer")},children:"SinglePlayer"}),Object(J.jsx)("li",{onClick:function(){n("two-player")},children:"Two-Player"})]})},Te=function(){var e=Object(c.b)(),n=Object(i.useState)(Object(J.jsx)(se,{})),o=Object(N.a)(n,2),t=o[0],r=o[1];Object(a.b)(b,(function(n){n?(e(be.login()),e(be.setRoomStatus("looking for room"))):(e(be.logout()),e(be.setRoomStatus(null)))})),Object(s.e)(p,(function(){b.currentUser&&Object(s.b)(p).then((function(n){n.exists()&&e(be.setInvitiationKeys(Object.entries(n.val()).filter((function(e){return!e[1].accepted&&e[1].player2===b.currentUser.uid})).map((function(e){return{opponentuid:e[1].player1,roomKey:e[0]}}))))}))})),Object(s.f)(p,(function(){b.currentUser&&Object(s.b)(p).then((function(n){n.exists()?e(be.setInvitiationKeys(Object.entries(n.val()).filter((function(e){return!e[1].accepted&&e[1].player2===b.currentUser.uid})).map((function(e){return{opponentuid:e[1].player1,roomKey:e[0]}})))):e(be.setInvitiationKeys([]))}))})),Object(s.h)(O,(function(){b.currentUser&&Object(s.b)(O).then((function(n){n.val()&&e(be.setOtherUsers(Object.entries(n.val()).filter((function(e){return e[0]!==b.currentUser.uid&&!e[1].inRoom}))))}))}));var l=Object(c.c)((function(e){return e.userInfo.roomKey}));return l&&Object(s.h)(Object(s.a)(p,l.payload+"/accepted"),(function(n){n.exists()?n.val()?(e(D.setMultiplayer({playerNumber:1,roomRef:Object(s.a)(p,l.payload)})),e(be.setRoomStatus("done waiting"))):e(be.setRoomStatus("waiting")):e(be.setRoomStatus("looking for room"))})),Object(J.jsxs)(u.a.Fragment,{children:[Object(J.jsx)(Ge,{setPage:function(n){e(D.reset()),"singleplayer"===n?r(Object(J.jsx)(se,{})):"two-player"===n&&r(Object(J.jsx)(Ce,{}))}}),t]})},De=Object(x.a)({reducer:{gameState:B,userInfo:fe}});r.a.createRoot(document.getElementById("root")).render(Object(J.jsx)(c.a,{store:De,children:Object(J.jsx)(Te,{})}))}},[[60,1,2]]]);
//# sourceMappingURL=main.1aec0d4d.chunk.js.map