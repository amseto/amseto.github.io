(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{11:function(e,o,n){e.exports={block:"Block_block__3nUuf",None:"Block_None__eAiB9",I:"Block_I__weOBk",T:"Block_T__1L-Xu",L:"Block_L__2ENJ9",J:"Block_J__1832g",Z:"Block_Z__2mhxn",S:"Block_S__3hrCd",O:"Block_O__1pSxP",Ighost:"Block_Ighost__1nPus",Tghost:"Block_Tghost__VDON1",Lghost:"Block_Lghost__2f0AL",Jghost:"Block_Jghost__1598_",Zghost:"Block_Zghost__2bH4-",Sghost:"Block_Sghost__18NWt",Oghost:"Block_Oghost__2eXdj"}},12:function(e,o,n){e.exports={pieceQueue:"PieceQueue_pieceQueue__1Znlf"}},13:function(e,o,n){e.exports={heldBlock:"HeldBlock_heldBlock__2MTTR"}},18:function(e,o,n){e.exports={gameUI:"gameUI_gameUI__26S52"}},21:function(e,o,n){e.exports={grid:"Grid_grid__ZIllk"}},22:function(e,o,n){e.exports={readyGo:"ReadyGo_readyGo__1ar4n"}},35:function(e,o,n){},37:function(e,o,n){"use strict";n.r(o);var t=n(15),N=n.n(t),r=n(3),c=(n(35),n(1)),s=n(18),a=n.n(s),i=n(5),u=n(2),l=n(7),h={I:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],T:[[[0,1,0],[1,1,1]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],L:[[[0,0,1],[1,1,1]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],Z:[[[1,1,0],[0,1,1]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],S:[[[0,1,1],[1,1,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],O:[[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]]]},d=n(19),f=n(20),j=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],g=function(){0===j.length&&(j=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"]);var e=Math.floor(j.length*Math.random());return j.splice(e,1)},P=function(e,o,n,t){return h[e][o].map((function(e,o){return e.map((function(e,N){return e?{x:n+N,y:t+o}:null}))}))},b=function(e,o){var n,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],N=[],r=Object(u.a)(o);try{for(r.s();!(n=r.n()).done;){var c,s=n.value,a=Object(u.a)(s);try{for(a.s();!(c=a.n()).done;){var i=c.value;i&&y(e,i,t)&&N.push(i)}}catch(l){a.e(l)}finally{a.f()}}}catch(l){r.e(l)}finally{r.f()}return N},x=function(e){var o,n=Object(u.a)(e.currentCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.grid[t.y][t.x]="None"}}catch(N){n.e(N)}finally{n.f()}},O=function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o){var n,t=e.currentShape+"ghost",N=Object(u.a)(e.ghostCoords);try{for(N.s();!(n=N.n()).done;){var r=n.value;e.grid[r.y][r.x]=t;var c,s=Object(u.a)(e.currentCoords);try{for(s.s();!(c=s.n()).done;){var a=c.value;a.y===r.y&&a.x===r.x&&(e.grid[r.y][r.x]=e.currentShape)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){N.e(d)}finally{N.f()}}else{var i,l=Object(u.a)(e.currentCoords);try{for(l.s();!(i=l.n()).done;){var h=i.value;e.grid[h.y][h.x]=e.currentShape}}catch(d){l.e(d)}finally{l.f()}}},y=function(e,o){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(o&&o.y<=20&&o.x>=0&&o.x<=9){var t,N=Object(u.a)(e.currentCoords);try{for(N.s();!(t=N.n()).done;){var r=t.value;if(n&&r.y===o.y&&r.x===o.x)return!0}}catch(c){N.e(c)}finally{N.f()}if(e.grid[o.y][o.x].length>1)return!0}return!1},p=new(function(){function e(){Object(d.a)(this,e),this.elements={},this.head=0,this.tail=0}return Object(f.a)(e,[{key:"enqueue",value:function(e){this.elements[this.tail]=e,this.tail++}},{key:"dequeue",value:function(){var e=this.elements[this.head];return delete this.elements[this.head],this.head++,e}},{key:"peek",value:function(){return this.elements[this.head]}},{key:"empty",value:function(){for(;!this.isEmpty;)this.dequeue()}},{key:"length",get:function(){return this.tail-this.head}},{key:"isEmpty",get:function(){return 0===this.length}}]),e}()),v=Object(l.b)({name:"gameState",initialState:{gameRunning:!1,currentShape:null,currentCoords:[],ghostCoords:[],currentPieceState:"NONE",rotatePos:0,xPos:3,yPos:0,totalLinesCleared:0,grid:[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],pieceQueue:null,isGameWon:!1,heldPiece:null,rotated:!1},reducers:{newGame:function(e){j=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.displayMessage="READY",e.currentPieceState="GETTING READY",p.empty(),e.gameRunning=!1},gettingReady:function(e){if("GETTING READY"===e.currentPieceState)e.currentPieceState="BEFORE START",e.displayMessage="GO!";else if("BEFORE START"===e.currentPieceState){e.displayMessage=null,e.gameRunning=!0,e.currentShape=g();for(var o=0;o<5;o++)p.enqueue.apply(p,Object(i.a)(g()))}},clearLines:function(e){var o,n=[],t=0,N=Object(u.a)(e.grid);try{for(N.s();!(o=N.n()).done;){var r=o.value;r.every((function(e){return"None"!==e}))?(e.totalLinesCleared+=1,t+=1):n.push(r)}}catch(s){N.e(s)}finally{N.f()}for(var c=0;c<t;c++)n.unshift(["None","None","None","None","None","None","None","None","None","None"]);e.grid=n},getNewPiece:function(e){if(e.gameRunning){if(e.ghostCoords=[],e.rotated=!1,e.currentShape=p.dequeue(),p.enqueue.apply(p,Object(i.a)(g())),e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4)return e.gameRunning=!1,void console.log("lost");O(e),e.currentPieceState="FALLING"}},rotatePiece:function(e,o){var n=e.rotatePos;e.rotatePos=function(e,o){var n=o.rotatePos;return e?0===n?3:n-1:3===n?0:n+1}(o.payload,{rotatePos:e.rotatePos}),x(e),e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.rotatePos=n,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",O(e)},dropPiece:function(e){if(e.gameRunning){if("LANDING"===e.currentPieceState)return void(e.currentPieceState="FROZEN");x(e),e.yPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.yPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentPieceState="LANDING"):e.currentPieceState="FALLING",O(e)}},getGhostCoords:function(e){if(e.gameRunning){!function(e){var o,n=Object(u.a)(e.ghostCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.grid[t.y][t.x]="None"}}catch(N){n.e(N)}finally{n.f()}}(e),e.ghostCoords=[];var o,n=Object(u.a)(e.currentCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.ghostCoords.push({x:t.x,y:t.y})}}catch(r){n.e(r)}finally{n.f()}for(var N=e.yPos;4===e.ghostCoords.length;)N+=1,e.ghostCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,N),!0);N-=1,e.ghostCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,N),!0)}},hardDrop:function(e){x(e),e.currentCoords=e.ghostCoords,O(e),e.currentPieceState="FROZEN"},showGhostPiece:function(e){e.gameRunning&&O(e,!0)},shiftLeft:function(e){x(e),e.xPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",O(e)},shiftRight:function(e){x(e),e.xPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",O(e)},checkIfGameWon:function(e){e.totalLinesCleared>=4&&(console.log("won"),e.isGameWon=!0,e.gameRunning=!1)},holdPiece:function(e){if(!0!==e.rotated){if(e.rotated=!0,x(e),null===e.heldPiece)e.heldPiece=e.currentShape,e.currentShape=p.dequeue(),p.enqueue.apply(p,Object(i.a)(g()));else{var o=e.currentShape;e.currentShape=e.heldPiece,e.heldPiece=o}e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),O(e),e.currentPieceState="FALLING"}}}}),m=v.actions,_=v.reducer,S=n(21),k=n.n(S),C=n(11),w=n.n(C),G=n(0),L=function(e){var o=e.color;return Object(G.jsx)("td",{className:"".concat(w.a.block,"  ").concat(w.a[o])})},I=function(e){var o=Object(r.c)((function(e){return e.gameState})).grid.slice(1).map((function(e,o){return Object(G.jsx)("tr",{children:e.map((function(e,o){return Object(G.jsx)(L,{color:e},o)}))},o)}));return Object(G.jsxs)("table",{className:k.a.grid,children:[Object(G.jsx)("tbody",{children:o}),e.children]})},R=function(e){var o=h[e.color][0].map((function(o,n){return Object(G.jsx)("tr",{children:o.map((function(o,n){return 0===o?Object(G.jsx)(L,{color:null},n):Object(G.jsx)(L,{color:e.color},n)}))},n)}));return Object(G.jsx)("li",{children:Object(G.jsx)("table",{children:Object(G.jsx)("tbody",{children:o})})})},B=n(12),E=n.n(B),T=function(e){var o=0,n=[];if(p.isEmpty)return Object(G.jsx)("ul",{className:E.a.pieceQueue});for(var t in p.elements)n.push(Object(G.jsx)(R,{color:p.elements[t]},o++));return Object(G.jsx)("ul",{className:E.a.pieceQueue,children:n})},A=n(13),Z=n.n(A),J=function(){var e=Object(r.c)((function(e){return e.gameState}));if(!e.heldPiece)return Object(G.jsx)("div",{className:Z.a.heldBlock,children:Object(G.jsx)("table",{children:Object(G.jsxs)("tbody",{children:[Object(G.jsxs)("tr",{children:[Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{})]}),Object(G.jsxs)("tr",{children:[Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{})]}),Object(G.jsxs)("tr",{children:[Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{}),Object(G.jsx)(L,{})]})]})})});var o=h[e.heldPiece][0].map((function(o,n){return Object(G.jsx)("tr",{children:o.map((function(o,n){return 0===o?Object(G.jsx)(L,{color:null},n):Object(G.jsx)(L,{color:e.heldPiece},n)}))},n)}));return console.log(o),Object(G.jsx)("div",{className:Z.a.heldBlock,children:Object(G.jsx)("table",{children:Object(G.jsx)("tbody",{children:o})})})};n(22);var D=function(){var e=Object(r.b)(),o=Object(r.c)((function(e){return e.gameState})),n={};window.addEventListener("keydown",(function(e){"Tab"===e.key&&(e.preventDefault(),e.stopPropagation())," "===e.key&&(e.preventDefault(),e.stopPropagation()),n[e.key]=!0})),window.addEventListener("keyup",(function(e){n[e.key]=!1}));var t=function(){o.gameRunning&&("FROZEN"===o.currentPieceState?(e(m.clearLines()),e(m.checkIfGameWon()),e(m.getNewPiece()),e(m.getGhostCoords()),e(m.showGhostPiece())):(e(m.dropPiece()),e(m.getGhostCoords()),e(m.showGhostPiece())))};Object(c.useEffect)((function(){var e=window.setInterval((function(){t()}),300),o=window.setInterval((function(){N()}),10);return function(){window.clearInterval(e),window.clearInterval(o)}}),[o,t,n]),Object(c.useEffect)((function(){var o=window.setInterval((function(){e(m.gettingReady())}),500);return function(){window.clearInterval(o)}}),[o.displayMessage,e]);var N=function(){o.gameRunning&&(n.q&&(e(m.rotatePiece(!0)),e(m.getGhostCoords()),e(m.showGhostPiece())),n.w&&(e(m.rotatePiece(!1)),e(m.getGhostCoords()),e(m.showGhostPiece())),n.ArrowDown&&e(m.dropPiece()),n.ArrowRight&&(e(m.shiftRight()),e(m.getGhostCoords()),e(m.showGhostPiece())),n.ArrowLeft&&(e(m.shiftLeft()),e(m.getGhostCoords()),e(m.showGhostPiece())),n[" "]&&e(m.hardDrop()),n.Tab&&(e(m.holdPiece()),e(m.getGhostCoords()),e(m.showGhostPiece())))};return document.onkeydown=function(o){"Escape"===o.key&&(e(m.newGame()),e(m.getNewPiece()),e(m.getGhostCoords()),e(m.showGhostPiece()))},Object(G.jsxs)(c.Fragment,{children:[Object(G.jsx)("h1",{children:"Ditris"}),Object(G.jsx)("button",{onClick:function(){e(m.newGame()),e(m.getNewPiece())},children:"Start/Pause"}),Object(G.jsx)("button",{onClick:function(){e(m.rotatePiece())},children:"Rotate"}),Object(G.jsx)("button",{onClick:function(){e(m.dropPiece())},children:"Drop"}),Object(G.jsx)("button",{onClick:function(){e(m.shiftLeft())},children:"Left"}),Object(G.jsx)("button",{onClick:function(){e(m.shiftRight())},children:"Right"}),Object(G.jsxs)("div",{className:a.a.gameUI,children:[Object(G.jsx)(J,{}),Object(G.jsx)(I,{children:Object(G.jsx)("div",{style:{"align-items":"center",position:"absolute",top:300,color:"yellow"},children:o.displayMessage})}),Object(G.jsx)(T,{})]})]})},F=Object(l.a)({reducer:{gameState:_}});N.a.createRoot(document.getElementById("root")).render(Object(G.jsxs)(r.a,{store:F,children:[" ",Object(G.jsx)(D,{})]}))}},[[37,1,2]]]);
//# sourceMappingURL=main.aa66d7d0.chunk.js.map