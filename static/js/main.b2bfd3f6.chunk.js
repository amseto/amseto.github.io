(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{11:function(e,o,n){e.exports={block:"Block_block__3nUuf",None:"Block_None__eAiB9",I:"Block_I__weOBk",T:"Block_T__1L-Xu",L:"Block_L__2ENJ9",J:"Block_J__1832g",Z:"Block_Z__2mhxn",S:"Block_S__3hrCd",O:"Block_O__1pSxP",Ighost:"Block_Ighost__1nPus",Tghost:"Block_Tghost__VDON1",Lghost:"Block_Lghost__2f0AL",Jghost:"Block_Jghost__1598_",Zghost:"Block_Zghost__2bH4-",Sghost:"Block_Sghost__18NWt",Oghost:"Block_Oghost__2eXdj"}},12:function(e,o,n){e.exports={pieceQueue:"PieceQueue_pieceQueue__1Znlf"}},13:function(e,o,n){e.exports={heldBlock:"HeldBlock_heldBlock__2MTTR"}},18:function(e,o,n){e.exports={gameUI:"gameUI_gameUI__26S52"}},21:function(e,o,n){e.exports={grid:"Grid_grid__ZIllk"}},22:function(e,o,n){e.exports={howToPlay:"HowToPlay_howToPlay__OMoNR"}},35:function(e,o,n){},37:function(e,o,n){"use strict";n.r(o);var t=n(15),r=n.n(t),N=n(3),c=(n(35),n(1)),s=n(18),a=n.n(s),i=n(5),u=n(2),l=n(7),h={I:[[[1,1,1,1],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],T:[[[0,1,0],[1,1,1]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],L:[[[0,0,1],[1,1,1]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],Z:[[[1,1,0],[0,1,1]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]],S:[[[0,1,1],[1,1,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],O:[[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]],[[0,1,1],[0,1,1]]]},d=n(19),f=n(20),g=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],j=function(){0===g.length&&(g=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"]);var e=Math.floor(g.length*Math.random());return g.splice(e,1)},P=function(e,o,n,t){return h[e][o].map((function(e,o){return e.map((function(e,r){return e?{x:n+r,y:t+o}:null}))}))},b=function(e,o){var n,t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[],N=Object(u.a)(o);try{for(N.s();!(n=N.n()).done;){var c,s=n.value,a=Object(u.a)(s);try{for(a.s();!(c=a.n()).done;){var i=c.value;i&&y(e,i,t)&&r.push(i)}}catch(l){a.e(l)}finally{a.f()}}}catch(l){N.e(l)}finally{N.f()}return r},O=function(e){var o,n=Object(u.a)(e.currentCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.grid[t.y][t.x]="None"}}catch(r){n.e(r)}finally{n.f()}},x=function(e){var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o){var n,t=e.currentShape+"ghost",r=Object(u.a)(e.ghostCoords);try{for(r.s();!(n=r.n()).done;){var N=n.value;e.grid[N.y][N.x]=t;var c,s=Object(u.a)(e.currentCoords);try{for(s.s();!(c=s.n()).done;){var a=c.value;a.y===N.y&&a.x===N.x&&(e.grid[N.y][N.x]=e.currentShape)}}catch(d){s.e(d)}finally{s.f()}}}catch(d){r.e(d)}finally{r.f()}}else{var i,l=Object(u.a)(e.currentCoords);try{for(l.s();!(i=l.n()).done;){var h=i.value;e.grid[h.y][h.x]=e.currentShape}}catch(d){l.e(d)}finally{l.f()}}},y=function(e,o){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(o&&o.y<=20&&o.x>=0&&o.x<=9){var t,r=Object(u.a)(e.currentCoords);try{for(r.s();!(t=r.n()).done;){var N=t.value;if(n&&N.y===o.y&&N.x===o.x)return!0}}catch(c){r.e(c)}finally{r.f()}if(e.grid[o.y][o.x].length>1)return!0}return!1},p=new(function(){function e(){Object(d.a)(this,e),this.elements={},this.head=0,this.tail=0}return Object(f.a)(e,[{key:"enqueue",value:function(e){this.elements[this.tail]=e,this.tail++}},{key:"dequeue",value:function(){var e=this.elements[this.head];return delete this.elements[this.head],this.head++,e}},{key:"peek",value:function(){return this.elements[this.head]}},{key:"empty",value:function(){for(;!this.isEmpty;)this.dequeue()}},{key:"length",get:function(){return this.tail-this.head}},{key:"isEmpty",get:function(){return 0===this.length}}]),e}()),w=Object(l.b)({name:"gameState",initialState:{gameRunning:!1,currentShape:null,currentCoords:[],ghostCoords:[],currentPieceState:"NONE",rotatePos:0,xPos:3,yPos:0,totalLinesCleared:0,grid:[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],pieceQueue:null,isGameWon:!1,heldPiece:null,rotated:!1},reducers:{gameLoop:function(e){},newGame:function(e){g=["I","I","T","T","L","L","J","J","Z","Z","S","S","O","O"],e.grid=[["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"],["None","None","None","None","None","None","None","None","None","None"]],e.xPos=3,e.yPos=0,e.rotatePos=0,e.totalLinesCleared=0,e.displayMessage="READY",e.currentPieceState="GETTING READY",p.empty(),e.gameRunning=!1},gettingReady:function(e){if("GETTING READY"===e.currentPieceState)e.currentPieceState="BEFORE START",e.displayMessage="GO!";else if("BEFORE START"===e.currentPieceState){e.displayMessage=null,e.gameRunning=!0,e.currentShape=j();for(var o=0;o<5;o++)p.enqueue.apply(p,Object(i.a)(j()))}},clearLines:function(e){var o,n=[],t=0,r=Object(u.a)(e.grid);try{for(r.s();!(o=r.n()).done;){var N=o.value;N.every((function(e){return"None"!==e}))?(e.totalLinesCleared+=1,t+=1):n.push(N)}}catch(s){r.e(s)}finally{r.f()}for(var c=0;c<t;c++)n.unshift(["None","None","None","None","None","None","None","None","None","None"]);e.grid=n},getNewPiece:function(e){if(e.gameRunning){if(e.ghostCoords=[],e.rotated=!1,e.currentShape=p.dequeue(),p.enqueue.apply(p,Object(i.a)(j())),e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4)return e.gameRunning=!1,void console.log("lost");x(e),e.currentPieceState="FALLING"}},rotatePiece:function(e,o){var n=e.rotatePos;e.rotatePos=function(e,o){var n=o.rotatePos;return e?0===n?3:n-1:3===n?0:n+1}(o.payload,{rotatePos:e.rotatePos}),O(e),e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.rotatePos=n,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",x(e)},dropPiece:function(e){if(e.gameRunning){if("LANDING"===e.currentPieceState)return void(e.currentPieceState="FROZEN");O(e),e.yPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.yPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentPieceState="LANDING"):e.currentPieceState="FALLING",x(e)}},getGhostCoords:function(e){if(e.gameRunning){!function(e){var o,n=Object(u.a)(e.ghostCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.grid[t.y][t.x]="None"}}catch(r){n.e(r)}finally{n.f()}}(e),e.ghostCoords=[];var o,n=Object(u.a)(e.currentCoords);try{for(n.s();!(o=n.n()).done;){var t=o.value;e.ghostCoords.push({x:t.x,y:t.y})}}catch(N){n.e(N)}finally{n.f()}for(var r=e.yPos;4===e.ghostCoords.length;)r+=1,e.ghostCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,r),!0);r-=1,e.ghostCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,r),!0)}},hardDrop:function(e){O(e),e.currentCoords=e.ghostCoords,x(e),e.currentPieceState="FROZEN"},showGhostPiece:function(e){e.gameRunning&&x(e,!0)},shiftLeft:function(e){O(e),e.xPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",x(e)},shiftRight:function(e){O(e),e.xPos+=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),e.currentCoords.length<4?(e.xPos-=1,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos))):e.currentPieceState="FALLING",x(e)},checkIfGameWon:function(e){e.totalLinesCleared>=4&&(console.log("won"),e.isGameWon=!0,e.gameRunning=!1)},holdPiece:function(e){if(!0!==e.rotated){if(e.rotated=!0,O(e),null===e.heldPiece)e.heldPiece=e.currentShape,e.currentShape=p.dequeue(),p.enqueue.apply(p,Object(i.a)(j()));else{var o=e.currentShape;e.currentShape=e.heldPiece,e.heldPiece=o}e.xPos=3,e.yPos=0,e.rotatePos=0,e.currentCoords=b(e,P(e.currentShape,e.rotatePos,e.xPos,e.yPos)),x(e),e.currentPieceState="FALLING"}},placeBlocks:function(e){}}}),v=w.actions,m=w.reducer,_=n(21),S=n.n(_),k=n(11),L=n.n(k),C=n(0),G=function(e){var o=e.color;return Object(C.jsx)("td",{className:"".concat(L.a.block,"  ").concat(L.a[o])})},A=function(e){var o=Object(N.c)((function(e){return e.gameState})),n=o.grid.slice(1).map((function(e,o){return Object(C.jsx)("tr",{children:e.map((function(e,o){return Object(C.jsx)(G,{color:e},o)}))},o)}));return Object(C.jsxs)("table",{className:S.a.grid,children:[Object(C.jsx)("tbody",{children:n}),Object(C.jsx)("div",{style:{"align-items":"center",position:"absolute",top:300,color:"yellow"},children:o.displayMessage})]})},R=function(e){var o=h[e.color][0].map((function(o,n){return Object(C.jsx)("tr",{children:o.map((function(o,n){return 0===o?Object(C.jsx)(G,{color:null},n):Object(C.jsx)(G,{color:e.color},n)}))},n)}));return Object(C.jsx)("li",{children:Object(C.jsx)("table",{children:Object(C.jsx)("tbody",{children:o})})})},I=n(12),T=n.n(I),B=function(e){var o=0,n=[];if(p.isEmpty)return Object(C.jsx)("ul",{className:T.a.pieceQueue});for(var t in p.elements)n.push(Object(C.jsx)(R,{color:p.elements[t]},o++));return Object(C.jsx)("ul",{className:T.a.pieceQueue,children:n})},E=n(13),D=n.n(E),Z=function(){var e=Object(N.c)((function(e){return e.gameState}));if(!e.heldPiece)return Object(C.jsx)("div",{className:D.a.heldBlock,children:Object(C.jsx)("table",{children:Object(C.jsxs)("tbody",{children:[Object(C.jsxs)("tr",{children:[Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{})]}),Object(C.jsxs)("tr",{children:[Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{}),Object(C.jsx)(G,{})]})]})})});var o=h[e.heldPiece][0].map((function(o,n){return Object(C.jsx)("tr",{children:o.map((function(o,n){return 0===o?Object(C.jsx)(G,{color:null},n):Object(C.jsx)(G,{color:e.heldPiece},n)}))},n)}));return console.log(o),Object(C.jsx)("div",{className:D.a.heldBlock,children:Object(C.jsx)("table",{children:Object(C.jsx)("tbody",{children:o})})})},J={},q={},F={},M=function(){window.addEventListener("keydown",(function(e){J[e.key]=!0,"Tab"===e.key&&(e.preventDefault(),e.stopPropagation())," "===e.key&&(e.preventDefault(),e.stopPropagation())})),window.addEventListener("keyup",(function(e){F[e.key]=0,J[e.key]=!1,q[e.key]=!1}))},Q=n(22),U=n.n(Q),W=function(){return Object(C.jsx)("div",{className:U.a.howToPlay,children:Object(C.jsxs)("ul",{children:[Object(C.jsx)("li",{children:"esc = start game"}),Object(C.jsx)("li",{children:"q = rotate counter clockwise"}),Object(C.jsx)("li",{children:"w = rotate clockwise"}),Object(C.jsx)("li",{children:"tab = hold"}),Object(C.jsx)("li",{children:"spacebar = hard drop"}),Object(C.jsx)("li",{children:"use arrows to move"})]})})};var H=function(){var e=Object(N.b)(),o=Object(N.c)((function(e){return e.gameState.gameRunning})),n=Object(N.c)((function(e){return e.gameState.currentPieceState})),t=Object(N.c)((function(e){return e.gameState.displayMessage}));Object(c.useEffect)((function(){var t=window.setInterval((function(){o&&("FROZEN"===n?(e(v.clearLines()),e(v.checkIfGameWon()),e(v.getNewPiece()),e(v.getGhostCoords()),e(v.showGhostPiece())):(e(v.dropPiece()),e(v.getGhostCoords()),e(v.showGhostPiece())))}),300),N=window.setInterval((function(){s()}),1),c=window.setInterval((function(){r()}),1);return function(){window.clearInterval(t),window.clearInterval(N),window.clearInterval(c)}})),Object(c.useEffect)((function(){var o=window.setInterval((function(){e(v.gettingReady())}),500);return function(){window.clearInterval(o)}}),[t,e]);var r=function(){if(o){for(var n in F)F[n]&&(F[n]+=1);J.ArrowDown&&q.ArrowDown&&F.ArrowDown>40&&(console.log("down"),e(v.dropPiece()),q.ArrowDown=!0,F.ArrowDown=20),J.ArrowRight&&q.ArrowRight&&F.ArrowRight>40&&(console.log("right"),e(v.shiftRight()),e(v.getGhostCoords()),e(v.showGhostPiece()),q.ArrowRight=!0,F.ArrowRight=20),J.ArrowLeft&&q.ArrowLeft&&F.ArrowLeft>40&&(console.log("left"),e(v.shiftLeft()),e(v.getGhostCoords()),e(v.showGhostPiece()),q.ArrowLeft=!0,F.ArrowLeft=20)}},s=function(){o&&(J.q&&!q.q&&(console.log("rotateLeft"),e(v.rotatePiece(!0)),e(v.getGhostCoords()),e(v.showGhostPiece()),q.q=!0),J.w&&!q.w&&(console.log("rotateRight"),e(v.rotatePiece(!1)),e(v.getGhostCoords()),e(v.showGhostPiece()),q.w=!0),J[" "]&&!q[" "]&&(e(v.hardDrop()),q[" "]=!0),J.Tab&&!q.Tab&&(e(v.holdPiece()),e(v.getGhostCoords()),e(v.showGhostPiece()),q.Tab=!0),J.ArrowDown&&!q.ArrowDown&&(e(v.dropPiece()),q.ArrowDown=!0),J.ArrowRight&&!q.ArrowRight&&(F.ArrowRight=1,e(v.shiftRight()),e(v.getGhostCoords()),e(v.showGhostPiece()),q.ArrowRight=!0),J.ArrowLeft&&!q.ArrowLeft&&(F.ArrowLeft=1,e(v.shiftLeft()),e(v.getGhostCoords()),e(v.showGhostPiece()),q.ArrowLeft=!0))};return document.onkeydown=function(o){"Escape"===o.key&&(e(v.newGame()),e(v.getNewPiece()),e(v.getGhostCoords()),e(v.showGhostPiece()))},Object(C.jsxs)(c.Fragment,{children:[Object(C.jsx)(M,{}),Object(C.jsx)("h1",{children:"Ditris"}),Object(C.jsxs)("div",{className:a.a.gameUI,children:[Object(C.jsx)(Z,{}),Object(C.jsx)(A,{}),Object(C.jsx)(B,{})]}),Object(C.jsx)(W,{})]})},Y=Object(l.a)({reducer:{gameState:m}});r.a.createRoot(document.getElementById("root")).render(Object(C.jsxs)(N.a,{store:Y,children:[" ",Object(C.jsx)(H,{})]}))}},[[37,1,2]]]);
//# sourceMappingURL=main.b2bfd3f6.chunk.js.map